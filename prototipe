import zipfile
import os
import time
import sys

print("""
+------------------------------------------+
| Program : Pemecah kata sandi file ZIP    |
| Pembuat : Rofi [FII14]                   |  
| Github  : https://github.com/FII14/PKSFZ |
+------------------------------------------+
| COPYRIGHT (C) 2023 FII14                 |
+------------------------------------------+
""")

while True:
    try:
        # Meminta input nama file ZIP
        nama_file_zip = input("Masukkan nama file ZIP: ")

        # Memeriksa apakah file ZIP ada
        if not os.path.isfile(nama_file_zip):
            print("File ZIP tidak ditemukan.")
        else:
            break
    except KeyboardInterrupt:
        print("\nKeluar dari program PKSFZ")
        exit(0)

while True:
    try:
        # Meminta input nama file wordlist
        nama_file_wordlist = input("Masukkan nama file wordlist: ")

        # Memeriksa apakah file wordlist ada
        if not os.path.isfile(nama_file_wordlist):
            print("File wordlist tidak ditemukan.")
        else:
            break
    except KeyboardInterrupt:
        print("\nKeluar dari program PKSFZ")
        exit(0)

# Membaca file wordlist dan mencoba kata sandi
with open(nama_file_wordlist, 'r') as wordlist:
    kata_sandi_ditemukan = False
    for kata_sandi in wordlist:
        kata_sandi = kata_sandi.strip()
        try:
            with zipfile.ZipFile(nama_file_zip, 'r') as file_zip:
                sys.stdout.write(f"\rMencoba kata sandi: {kata_sandi} ")
                sys.stdout.flush()
                time.sleep(0.1)  # Waktu jeda animasi
                file_zip.extractall(pwd=kata_sandi.encode())
                sys.stdout.write("\n")
                print(f"\nKata sandi ditemukan: {kata_sandi}")
                kata_sandi_ditemukan = True
                break
        except Exception:
            sys.stdout.write("\rMencoba kata sandi:                    ")
            sys.stdout.flush()

    if not kata_sandi_ditemukan:
        sys.stdout.write("\rMencoba kata sandi:                    \n")
        print("\nKata sandi tidak ditemukan dalam wordlist.")

